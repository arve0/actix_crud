var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function c(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(t,e,n){t.$$.on_destroy.push(function(t,e){const n=t.subscribe(e);return n.unsubscribe?()=>n.unsubscribe():n}(e,n))}function u(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function i(t){t.parentNode.removeChild(t)}function d(t){return document.createElement(t)}function l(t){return document.createTextNode(t)}function f(){return l(" ")}function p(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function h(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function m(t,e){e=""+e,t.data!==e&&(t.data=e)}function $(t,e){(null!=e||t.value)&&(t.value=e)}let g;function v(t){g=t}function b(){const t=g;return(e,n)=>{const o=t.$$.callbacks[e];if(o){const c=function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);o.slice().forEach(e=>{e.call(t,c)})}}}const w=[],y=[],_=[],x=[],k=Promise.resolve();let E=!1;function C(t){_.push(t)}function T(){const t=new Set;do{for(;w.length;){const t=w.shift();v(t),L(t.$$)}for(;y.length;)y.pop()();for(let e=0;e<_.length;e+=1){const n=_[e];t.has(n)||(n(),t.add(n))}_.length=0}while(w.length);for(;x.length;)x.pop()();E=!1}function L(t){t.fragment&&(t.update(t.dirty),o(t.before_update),t.fragment.p(t.dirty,t.ctx),t.dirty=null,t.after_update.forEach(C))}const D=new Set;let N;function S(){N={r:0,c:[],p:N}}function O(){N.r||o(N.c),N=N.p}function P(t,e){t&&t.i&&(D.delete(t),t.i(e))}function R(t,e,n,o){if(t&&t.o){if(D.has(t))return;D.add(t),N.c.push(()=>{D.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}}function q(t,e){t.d(1),e.delete(t.key)}function M(t,n,s){const{fragment:r,on_mount:u,on_destroy:a,after_update:i}=t.$$;r.m(n,s),C(()=>{const n=u.map(e).filter(c);a?a.push(...n):o(n),t.$$.on_mount=[]}),i.forEach(C)}function j(t,e){t.$$.fragment&&(o(t.$$.on_destroy),t.$$.fragment.d(e),t.$$.on_destroy=t.$$.fragment=null,t.$$.ctx={})}function I(t,e){t.$$.dirty||(w.push(t),E||(E=!0,k.then(T)),t.$$.dirty=n()),t.$$.dirty[e]=!0}function H(e,c,s,r,u,a){const i=g;v(e);const d=c.props||{},l=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(i?i.$$.context:[]),callbacks:n(),dirty:null};let f=!1;var p;l.ctx=s?s(e,d,(t,n)=>{l.ctx&&u(l.ctx[t],l.ctx[t]=n)&&(l.bound[t]&&l.bound[t](n),f&&I(e,t))}):d,l.update(),f=!0,o(l.before_update),l.fragment=r(l.ctx),c.target&&(c.hydrate?l.fragment.l((p=c.target,Array.from(p.childNodes))):l.fragment.c(),c.intro&&P(e.$$.fragment),M(e,c.target,c.anchor),T()),v(i)}class A{$destroy(){j(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}function U(e){var n,o,c,s,r,p,m,$,g,v,b,w,y,_,x;return{c(){n=d("h1"),o=l(e.prettyType),c=f(),s=d("form"),(r=d("label")).textContent="Username",p=f(),m=d("input"),$=f(),(g=d("label")).textContent="Password",v=f(),b=d("input"),w=f(),y=d("button"),_=l(e.prettyType),h(r,"for","username"),h(r,"class","svelte-d00odx"),h(m,"id","username"),h(m,"name","username"),h(g,"for","password"),h(g,"class","svelte-d00odx"),h(b,"id","password"),h(b,"name","password"),h(b,"type","password"),h(y,"type","submit"),h(y,"class","button svelte-d00odx"),h(s,"action",x="/user/"+e.type),h(s,"method","POST")},m(t,e){a(t,n,e),u(n,o),a(t,c,e),a(t,s,e),u(s,r),u(s,p),u(s,m),u(s,$),u(s,g),u(s,v),u(s,b),u(s,w),u(s,y),u(y,_)},p(t,e){t.type&&x!==(x="/user/"+e.type)&&h(s,"action",x)},i:t,o:t,d(t){t&&(i(n),i(c),i(s))}}}function J(t,e,n){let{type:o="login"}=e,c=o[0].toUpperCase()+o.slice(1);return t.$set=(t=>{"type"in t&&n("type",o=t.type)}),{type:o,prettyType:c}}class B extends A{constructor(t){super(),H(this,t,J,U,s,["type"])}}const z=[];function F(t,e){return{subscribe:G(t,e).subscribe}}function G(e,n=t){let o;const c=[];function r(t){if(s(e,t)&&(e=t,o)){const t=!z.length;for(let t=0;t<c.length;t+=1){const n=c[t];n[1](),z.push(n,e)}if(t){for(let t=0;t<z.length;t+=2)z[t][0](z[t+1]);z.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(s,u=t){const a=[s,u];return c.push(a),1===c.length&&(o=n(r)||t),s(e),()=>{const t=c.indexOf(a);-1!==t&&c.splice(t,1),0===c.length&&(o(),o=null)}}}}const K=fetch("/user").then(t=>200!==t.status?null:t.text()),Q=F(null,t=>{K.then(t)}),V=F(!1,t=>{K.then(t=>null!==t).then(t)}),W=K.then(t=>null!==t),X="/document",Y=W.then(t=>t?fetch(X):{}).then(t=>200!==t.status?[]:t.json()),{set:Z,subscribe:tt,update:et}=G([],t=>Y.then(t));const nt={create:async function(t){let e=await fetch(X,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)});if(201!==e.status){let t=await e.text();throw new Error(`HTTP status ${e.status}, message '${t}'`)}let n=await e.text();et(e=>[...e,{id:n,data:t}])},delete_:async function(t){let e=await fetch(`${X}/${t}`,{method:"DELETE"});if(200!==e.status){let t=await e.text();throw new Error(`HTTP status ${e.status}, message '${t}'`)}et(e=>{const n=e.findIndex(e=>e.id===t);if(-1===n)throw new Error(`Expected to find id ${t}, but did not.`);return[...e.slice(0,n),...e.slice(n+1)]})},subscribe:tt,put:async function(t){let{id:e,data:n}=t,o=await fetch(`${X}/${e}`,{method:"PUT",headers:{"content-type":"application/json"},body:JSON.stringify(n)});if(200!==o.status){let t=await o.text();throw new Error(`HTTP status ${o.status}, message '${t}'`)}et(n=>{const o=n.findIndex(t=>t.id===e);if(-1===o)throw new Error(`Expected to find id ${e}, but did not.`);return[...n.slice(0,o),t,...n.slice(o+1)]})}};function ot(e){var n,c,s,r,g,v,b,w,y,_,x,k,E,C,T,L,D,N,S,O,P,R,q,M,j,I;return{c(){n=d("h2"),c=l(e.title),s=l(" document"),r=f(),g=d("form"),(v=d("label")).textContent="Date",b=f(),w=d("input"),y=f(),(_=d("label")).textContent="Description",x=f(),k=d("input"),E=f(),(C=d("label")).textContent="Amount",T=f(),L=d("input"),D=f(),(N=d("label")).textContent="Done",S=f(),O=d("input"),P=f(),R=d("div"),(q=d("button")).textContent="Save",M=f(),(j=d("button")).textContent="Cancel",h(n,"class","subtitle"),h(v,"for","date"),h(v,"class","svelte-belg7s"),h(w,"id","date"),h(w,"type","date"),h(_,"for","description"),h(_,"class","svelte-belg7s"),h(k,"id","description"),h(k,"type","text"),h(C,"for","amount"),h(C,"class","svelte-belg7s"),h(L,"id","amount"),h(L,"type","number"),h(N,"for","done"),h(N,"class","svelte-belg7s"),h(O,"id","done"),h(O,"type","checkbox"),h(q,"type","submit"),h(R,"class","action svelte-belg7s"),I=[p(w,"input",e.input0_input_handler),p(k,"input",e.input1_input_handler),p(L,"input",e.input2_input_handler),p(O,"change",e.input3_change_handler),p(j,"click",e.click_handler),p(g,"submit",e.submit)]},m(t,o){a(t,n,o),u(n,c),u(n,s),a(t,r,o),a(t,g,o),u(g,v),u(g,b),u(g,w),$(w,e.data.date),u(g,y),u(g,_),u(g,x),u(g,k),$(k,e.data.description),u(g,E),u(g,C),u(g,T),u(g,L),$(L,e.data.amount),u(g,D),u(g,N),u(g,S),u(g,O),O.checked=e.data.done,u(g,P),u(g,R),u(R,q),u(R,M),u(R,j)},p(t,e){t.title&&m(c,e.title),t.data&&$(w,e.data.date),t.data&&k.value!==e.data.description&&$(k,e.data.description),t.data&&$(L,e.data.amount),t.data&&(O.checked=e.data.done)},i:t,o:t,d(t){t&&(i(n),i(r),i(g)),o(I)}}}function ct(t,e,n){let{document:o}=e;const c=b();let s,r,u;return t.$set=(t=>{"document"in t&&n("document",o=t.document)}),t.$$.update=((t={document:1,isNew:1})=>{t.document&&n("data",s=o.data),t.document&&n("isNew",r=null===o.id),t.isNew&&n("title",u=r?"New":"Edit")}),{document:o,dispatch:c,submit:function(t){t.preventDefault(),r?nt.create(s).then(()=>c("done")):nt.put(o).then(()=>c("done"))},data:s,title:u,input0_input_handler:function(){s.date=this.value,n("data",s),n("document",o)},input1_input_handler:function(){s.description=this.value,n("data",s),n("document",o)},input2_input_handler:function(){var t;s.amount=""===(t=this.value)?void 0:+t,n("data",s),n("document",o)},input3_change_handler:function(){s.done=this.checked,n("data",s),n("document",o)},click_handler:function(){return c("done")}}}class st extends A{constructor(t){super(),H(this,t,ct,ot,s,["document"])}}function rt(t,e,n){const o=Object.create(t);return o.doc=e[n],o}function ut(t){var e,n,o,c=[],s=new Map,r=t.$documents;const l=t=>t.doc.id;for(var p=0;p<r.length;p+=1){let e=rt(t,r,p),n=l(e);s.set(n,c[p]=at(n,e))}return{c(){for(e=d("table"),(n=d("thead")).innerHTML='<tr><th class="svelte-1fv41r1">date</th> <th class="svelte-1fv41r1">description</th> <th class="svelte-1fv41r1">amount</th> <th class="svelte-1fv41r1">done</th> <th class="svelte-1fv41r1">actions</th></tr>',o=f(),p=0;p<c.length;p+=1)c[p].c();h(e,"class","table svelte-1fv41r1")},m(t,s){for(a(t,e,s),u(e,n),u(e,o),p=0;p<c.length;p+=1)c[p].m(e,null)},p(t,n){const o=n.$documents;c=function(t,e,n,o,c,s,r,u,a,i,d,l){let f=t.length,p=s.length,h=f;const m={};for(;h--;)m[t[h].key]=h;const $=[],g=new Map,v=new Map;for(h=p;h--;){const t=l(c,s,h),u=n(t);let a=r.get(u);a?o&&a.p(e,t):(a=i(u,t)).c(),g.set(u,$[h]=a),u in m&&v.set(u,Math.abs(h-m[u]))}const b=new Set,w=new Set;function y(t){P(t,1),t.m(u,d),r.set(t.key,t),d=t.first,p--}for(;f&&p;){const e=$[p-1],n=t[f-1],o=e.key,c=n.key;e===n?(d=e.first,f--,p--):g.has(c)?!r.has(o)||b.has(o)?y(e):w.has(c)?f--:v.get(o)>v.get(c)?(w.add(o),y(e)):(b.add(c),f--):(a(n,r),f--)}for(;f--;){const e=t[f];g.has(e.key)||a(e,r)}for(;p;)y($[p-1]);return $}(c,t,l,1,n,o,s,e,q,at,null,rt)},d(t){for(t&&i(e),p=0;p<c.length;p+=1)c[p].d()}}}function at(t,e){var n,c,s,r,$,g,v,b,w,y,_,x,k,E,C,T,L,D,N,S=e.doc.data.date+"",O=e.doc.data.description+"",P=e.doc.data.amount+"",R=e.doc.data.done?"✅":"❌";function q(){return e.click_handler(e)}function M(){return e.click_handler_1(e)}return{key:t,first:null,c(){n=d("tr"),c=d("td"),s=l(S),r=f(),$=d("td"),g=l(O),v=f(),b=d("td"),w=l(P),y=f(),_=d("td"),x=l(R),k=f(),E=d("td"),(C=d("button")).textContent="Edit",T=f(),(L=d("button")).textContent="Delete",D=f(),h(c,"class","svelte-1fv41r1"),h($,"class","svelte-1fv41r1"),h(b,"class","svelte-1fv41r1"),h(_,"class","svelte-1fv41r1"),h(C,"class","svelte-1fv41r1"),h(L,"class","svelte-1fv41r1"),h(E,"class","svelte-1fv41r1"),N=[p(C,"click",q),p(L,"click",M)],this.first=n},m(t,e){a(t,n,e),u(n,c),u(c,s),u(n,r),u(n,$),u($,g),u(n,v),u(n,b),u(b,w),u(n,y),u(n,_),u(_,x),u(n,k),u(n,E),u(E,C),u(E,T),u(E,L),u(n,D)},p(t,n){e=n,t.$documents&&S!==(S=e.doc.data.date+"")&&m(s,S),t.$documents&&O!==(O=e.doc.data.description+"")&&m(g,O),t.$documents&&P!==(P=e.doc.data.amount+"")&&m(w,P),t.$documents&&R!==(R=e.doc.data.done?"✅":"❌")&&m(x,R)},d(t){t&&i(n),o(N)}}}function it(e){var n,o;return{c(){(n=d("button")).textContent="Create new document",o=p(n,"click",e.create)},m(t,e){a(t,n,e)},p:t,i:t,o:t,d(t){t&&i(n),o()}}}function dt(t){var e,n=new st({props:{document:t.document}});return n.$on("done",t.done),{c(){n.$$.fragment.c()},m(t,o){M(n,t,o),e=!0},p(t,e){var o={};t.document&&(o.document=e.document),n.$set(o)},i(t){e||(P(n.$$.fragment,t),e=!0)},o(t){R(n.$$.fragment,t),e=!1},d(t){j(n,t)}}}function lt(t){var e,n,o,c,s,r,u,p=t.$documents.length&&ut(t),h=[dt,it],m=[];function $(t,e){return e.show_input_form?0:1}return c=$(0,t),s=m[c]=h[c](t),{c(){(e=d("h1")).textContent="Documents",n=f(),p&&p.c(),o=f(),s.c(),r=l("")},m(t,s){a(t,e,s),a(t,n,s),p&&p.m(t,s),a(t,o,s),m[c].m(t,s),a(t,r,s),u=!0},p(t,e){e.$documents.length?p?p.p(t,e):((p=ut(e)).c(),p.m(o.parentNode,o)):p&&(p.d(1),p=null);var n=c;(c=$(0,e))===n?m[c].p(t,e):(S(),R(m[n],1,1,()=>{m[n]=null}),O(),(s=m[c])||(s=m[c]=h[c](e)).c(),P(s,1),s.m(r.parentNode,r))},i(t){u||(P(s),u=!0)},o(t){R(s),u=!1},d(t){t&&(i(e),i(n)),p&&p.d(t),t&&i(o),m[c].d(t),t&&i(r)}}}function ft(t,e,n){let o;r(t,nt,t=>{n("$documents",o=t)});let c=!1,s={};function u(t){n("document",s=t),n("show_input_form",c=!0)}function a(t){s.id===t&&(n("show_input_form",c=!1),n("document",s={})),nt.delete_(t)}return{show_input_form:c,document:s,create:function(){n("document",s={id:null,data:{date:"",description:"",amount:0,done:!1}}),n("show_input_form",c=!0)},edit:u,done:function(){n("show_input_form",c=!1),n("document",s={})},delete_:a,$documents:o,click_handler:function({doc:t}){return u(t)},click_handler_1:function({doc:t}){return a(t.id)}}}class pt extends A{constructor(t){super(),H(this,t,ft,lt,s,[])}}function ht(e){var n,o;return{c(){(n=d("button")).textContent="Register",h(n,"class","svelte-104w8eq"),o=p(n,"click",e.showRegisterDialog)},m(t,e){a(t,n,e)},p:t,d(t){t&&i(n),o()}}}function mt(e){var n,o;return{c(){(n=d("button")).textContent="Log in",h(n,"class","svelte-104w8eq"),o=p(n,"click",e.showLoginDialog)},m(t,e){a(t,n,e)},p:t,d(t){t&&i(n),o()}}}function $t(t){var e,n,o,c;return{c(){e=d("a"),n=l("Logout ("),o=l(t.$username),c=l(")"),h(e,"class","button svelte-104w8eq"),h(e,"href","/user/logout")},m(t,s){a(t,e,s),u(e,n),u(e,o),u(e,c)},p(t,e){t.$username&&m(o,e.$username)},d(t){t&&i(e)}}}function gt(t){var e,n=new B({props:{type:"register"}});return{c(){n.$$.fragment.c()},m(t,o){M(n,t,o),e=!0},i(t){e||(P(n.$$.fragment,t),e=!0)},o(t){R(n.$$.fragment,t),e=!1},d(t){j(n,t)}}}function vt(t){var e,n=new B({});return{c(){n.$$.fragment.c()},m(t,o){M(n,t,o),e=!0},i(t){e||(P(n.$$.fragment,t),e=!0)},o(t){R(n.$$.fragment,t),e=!1},d(t){j(n,t)}}}function bt(t){var e,n=new pt({});return{c(){n.$$.fragment.c()},m(t,o){M(n,t,o),e=!0},i(t){e||(P(n.$$.fragment,t),e=!0)},o(t){R(n.$$.fragment,t),e=!1},d(t){j(n,t)}}}function wt(t){var e,n,o,c,s,r,l,p,m,$,g;function v(t,e){return e.$loggedIn?$t:e.showRegister?mt:e.showLogin?ht:void 0}var b=v(0,t),w=b&&b(t),y=[bt,vt,gt],_=[];function x(t,e){return e.$loggedIn?0:e.showLogin?1:e.showRegister?2:-1}return~(m=x(0,t))&&($=_[m]=y[m](t)),{c(){e=d("header"),(n=d("div")).innerHTML='<a href="/">actix crud</a>',o=f(),c=d("div"),s=f(),r=d("div"),w&&w.c(),l=f(),p=d("main"),$&&$.c(),h(n,"class","brand svelte-104w8eq"),h(c,"class","menu"),h(r,"class","login"),h(e,"class","svelte-104w8eq"),h(p,"class","svelte-104w8eq")},m(t,i){a(t,e,i),u(e,n),u(e,o),u(e,c),u(e,s),u(e,r),w&&w.m(r,null),a(t,l,i),a(t,p,i),~m&&_[m].m(p,null),g=!0},p(t,e){b===(b=v(0,e))&&w?w.p(t,e):(w&&w.d(1),(w=b&&b(e))&&(w.c(),w.m(r,null)));var n=m;(m=x(0,e))!==n&&($&&(S(),R(_[n],1,1,()=>{_[n]=null}),O()),~m?(($=_[m])||($=_[m]=y[m](e)).c(),P($,1),$.m(p,null)):$=null)},i(t){g||(P($),g=!0)},o(t){R($),g=!1},d(t){t&&i(e),w&&w.d(),t&&(i(l),i(p)),~m&&_[m].d()}}}function yt(t,e,n){let o,c;r(t,V,t=>{n("$loggedIn",o=t)}),r(t,Q,t=>{n("$username",c=t)});let s=!o,u=!1;return{showLogin:s,showRegister:u,showLoginDialog:function(){n("showRegister",u=!1),n("showLogin",s=!0)},showRegisterDialog:function(){n("showLogin",s=!1),n("showRegister",u=!0)},$loggedIn:o,$username:c}}return new class extends A{constructor(t){super(),H(this,t,yt,wt,s,[])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
