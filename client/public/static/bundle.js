var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function s(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(t,e,n){t.$$.on_destroy.push(function(t,e){const n=t.subscribe(e);return n.unsubscribe?()=>n.unsubscribe():n}(e,n))}function a(t,e){t.appendChild(e)}function u(t,e,n){t.insertBefore(e,n||null)}function i(t){t.parentNode.removeChild(t)}function l(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function f(){return d(" ")}function p(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function h(t,e){e=""+e,t.data!==e&&(t.data=e)}function $(t,e){(null!=e||t.value)&&(t.value=e)}let g;function v(t){g=t}function b(){const t=function(){if(!g)throw new Error("Function called outside component initialization");return g}();return(e,n)=>{const o=t.$$.callbacks[e];if(o){const s=function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);o.slice().forEach(e=>{e.call(t,s)})}}}const y=[],x=[],w=[],E=[],k=Promise.resolve();let C=!1;function S(t){w.push(t)}function _(){const t=new Set;do{for(;y.length;){const t=y.shift();v(t),T(t.$$)}for(;x.length;)x.pop()();for(let e=0;e<w.length;e+=1){const n=w[e];t.has(n)||(n(),t.add(n))}w.length=0}while(y.length);for(;E.length;)E.pop()();C=!1}function T(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(S)}}const j=new Set;let N;function L(){N={r:0,c:[],p:N}}function O(){N.r||o(N.c),N=N.p}function P(t,e){t&&t.i&&(j.delete(t),t.i(e))}function D(t,e,n,o){if(t&&t.o){if(j.has(t))return;j.add(t),N.c.push(()=>{j.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}}function M(t,e){t.d(1),e.delete(t.key)}function J(t){t&&t.c()}function A(t,n,c){const{fragment:r,on_mount:a,on_destroy:u,after_update:i}=t.$$;r&&r.m(n,c),S(()=>{const n=a.map(e).filter(s);u?u.push(...n):o(n),t.$$.on_mount=[]}),i.forEach(S)}function H(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function I(t,e){-1===t.$$.dirty[0]&&(y.push(t),C||(C=!0,k.then(_)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function U(e,s,c,r,a,u,i=[-1]){const l=g;v(e);const d=s.props||{},f=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:a,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:n(),dirty:i};let p=!1;var m;f.ctx=c?c(e,d,(t,n,o=n)=>(f.ctx&&a(f.ctx[t],f.ctx[t]=o)&&(f.bound[t]&&f.bound[t](o),p&&I(e,t)),n)):[],f.update(),p=!0,o(f.before_update),f.fragment=!!r&&r(f.ctx),s.target&&(s.hydrate?f.fragment&&f.fragment.l((m=s.target,Array.from(m.childNodes))):f.fragment&&f.fragment.c(),s.intro&&P(e.$$.fragment),A(e,s.target,s.anchor),_()),v(l)}class V{$destroy(){H(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}function q(e){let n,o,s,c,r,d,p,h,$,g,v,b,y;return{c(){(n=l("h1")).textContent=`${e[1]}`,o=f(),s=l("form"),(c=l("label")).textContent="Username",r=f(),d=l("input"),p=f(),(h=l("label")).textContent="Password",$=f(),g=l("input"),v=f(),(b=l("button")).textContent=`${e[1]}`,m(c,"for","username"),m(c,"class","svelte-d00odx"),m(d,"id","username"),m(d,"name","username"),m(h,"for","password"),m(h,"class","svelte-d00odx"),m(g,"id","password"),m(g,"name","password"),m(g,"type","password"),m(b,"type","submit"),m(b,"class","button svelte-d00odx"),m(s,"action",y="/user/"+e[0]),m(s,"method","POST")},m(t,e){u(t,n,e),u(t,o,e),u(t,s,e),a(s,c),a(s,r),a(s,d),a(s,p),a(s,h),a(s,$),a(s,g),a(s,v),a(s,b)},p(t,[e]){1&e&&y!==(y="/user/"+t[0])&&m(s,"action",y)},i:t,o:t,d(t){t&&i(n),t&&i(o),t&&i(s)}}}function z(t,e,n){let{type:o="login"}=e,s=o[0].toUpperCase()+o.slice(1);return t.$set=(t=>{"type"in t&&n(0,o=t.type)}),[o,s]}class B extends V{constructor(t){super(),U(this,t,z,q,c,{type:0})}}const F=[];function R(t,e){return{subscribe:G(t,e).subscribe}}function G(e,n=t){let o;const s=[];function r(t){if(c(e,t)&&(e=t,o)){const t=!F.length;for(let t=0;t<s.length;t+=1){const n=s[t];n[1](),F.push(n,e)}if(t){for(let t=0;t<F.length;t+=2)F[t][0](F[t+1]);F.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(c,a=t){const u=[c,a];return s.push(u),1===s.length&&(o=n(r)||t),c(e),()=>{const t=s.indexOf(u);-1!==t&&s.splice(t,1),0===s.length&&(o(),o=null)}}}}const K=fetch("/user").then(t=>200!==t.status?null:t.text()),Q=R(null,t=>{K.then(t)}),W=R(!1,t=>{K.then(t=>null!==t).then(t)}),X=K.then(t=>null!==t),Y="/document",Z=X.then(t=>t?fetch(Y):{}).then(t=>200!==t.status?[]:t.json()),{set:tt,subscribe:et,update:nt}=G([],t=>Z.then(t));const ot=new EventSource("/updates");function st(t){let e=JSON.parse(t.data);nt(t=>[...t,e])}function ct(t){let e=JSON.parse(t.data);nt(t=>t.map(t=>t.id===e.id?e:t))}function rt(t){let e=t.data;nt(t=>t.filter(t=>t.id!==e))}ot.addEventListener("insert",st),ot.addEventListener("update",ct),ot.addEventListener("delete",rt),window.addEventListener("storage",function(t){"insert"===t.key?st({data:t.newValue}):"update"===t.key?ct({data:t.newValue}):"delete"===t.key&&rt({data:t.newValue})});const at={create:async function(t){let e=await fetch(Y,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)});if(201!==e.status){let t=await e.text();throw new Error(`HTTP status ${e.status}, message '${t}'`)}let n={id:await e.text(),data:t};nt(t=>[...t,n]),localStorage.setItem("insert",JSON.stringify(n))},delete_:async function(t){let e=await fetch(`${Y}/${t}`,{method:"DELETE"});if(200!==e.status){let t=await e.text();throw new Error(`HTTP status ${e.status}, message '${t}'`)}nt(e=>{const n=e.findIndex(e=>e.id===t);if(-1===n)throw new Error(`Expected to find id ${t}, but did not.`);return[...e.slice(0,n),...e.slice(n+1)]}),localStorage.setItem("delete",t)},subscribe:et,put:async function(t){let{id:e,data:n}=t,o=await fetch(`${Y}/${e}`,{method:"PUT",headers:{"content-type":"application/json"},body:JSON.stringify(n)});if(200!==o.status){let t=await o.text();throw new Error(`HTTP status ${o.status}, message '${t}'`)}nt(n=>{const o=n.findIndex(t=>t.id===e);if(-1===o)throw new Error(`Expected to find id ${e}, but did not.`);return[...n.slice(0,o),t,...n.slice(o+1)]}),localStorage.setItem("update",JSON.stringify(t))}};function ut(e){let n,s,c,r,g,v,b,y,x,w,E,k,C,S,_,T,j,N,L,O,P,D,M,J,A,H,I=!1;function U(){I=!0,e[8].call(T)}return{c(){n=l("h2"),s=d(e[1]),c=d(" document"),r=f(),g=l("form"),(v=l("label")).textContent="Date",b=f(),y=l("input"),x=f(),(w=l("label")).textContent="Description",E=f(),k=l("input"),C=f(),(S=l("label")).textContent="Amount",_=f(),T=l("input"),j=f(),(N=l("label")).textContent="Done",L=f(),O=l("input"),P=f(),D=l("div"),(M=l("button")).textContent="Save",J=f(),(A=l("button")).textContent="Cancel",m(n,"class","subtitle"),m(v,"for","date"),m(v,"class","svelte-belg7s"),m(y,"id","date"),m(y,"type","date"),m(w,"for","description"),m(w,"class","svelte-belg7s"),m(k,"id","description"),m(k,"type","text"),m(S,"for","amount"),m(S,"class","svelte-belg7s"),m(T,"id","amount"),m(T,"type","number"),m(N,"for","done"),m(N,"class","svelte-belg7s"),m(O,"id","done"),m(O,"type","checkbox"),m(M,"type","submit"),m(D,"class","action svelte-belg7s"),H=[p(y,"input",e[6]),p(k,"input",e[7]),p(T,"input",U),p(O,"change",e[9]),p(A,"click",e[10]),p(g,"submit",e[3])]},m(t,o){u(t,n,o),a(n,s),a(n,c),u(t,r,o),u(t,g,o),a(g,v),a(g,b),a(g,y),$(y,e[0].date),a(g,x),a(g,w),a(g,E),a(g,k),$(k,e[0].description),a(g,C),a(g,S),a(g,_),a(g,T),$(T,e[0].amount),a(g,j),a(g,N),a(g,L),a(g,O),O.checked=e[0].done,a(g,P),a(g,D),a(D,M),a(D,J),a(D,A)},p(t,[e]){2&e&&h(s,t[1]),1&e&&$(y,t[0].date),1&e&&k.value!==t[0].description&&$(k,t[0].description),!I&&1&e&&$(T,t[0].amount),I=!1,1&e&&(O.checked=t[0].done)},i:t,o:t,d(t){t&&i(n),t&&i(r),t&&i(g),o(H)}}}function it(t,e,n){let{document:o}=e;const s=b();let c,r,a;return t.$set=(t=>{"document"in t&&n(4,o=t.document)}),t.$$.update=(()=>{16&t.$$.dirty&&n(0,c=o.data),16&t.$$.dirty&&n(5,r=null===o.id),32&t.$$.dirty&&n(1,a=r?"New":"Edit")}),[c,a,s,function(t){t.preventDefault(),r?at.create(c).then(()=>s("done")):at.put(o).then(()=>s("done"))},o,r,function(){c.date=this.value,n(0,c),n(4,o)},function(){c.description=this.value,n(0,c),n(4,o)},function(){var t;c.amount=""===(t=this.value)?void 0:+t,n(0,c),n(4,o)},function(){c.done=this.checked,n(0,c),n(4,o)},()=>s("done")]}class lt extends V{constructor(t){super(),U(this,t,it,ut,c,{document:4})}}function dt(t,e,n){const o=t.slice();return o[9]=e[n],o}function ft(t){let e,n,o,s=[],c=new Map,r=t[2];const d=t=>t[9].id;for(let e=0;e<r.length;e+=1){let n=dt(t,r,e),o=d(n);c.set(o,s[e]=pt(o,n))}return{c(){e=l("table"),(n=l("thead")).innerHTML='<tr><th class="svelte-1fv41r1">date</th> \n                <th class="svelte-1fv41r1">description</th> \n                <th class="svelte-1fv41r1">amount</th> \n                <th class="svelte-1fv41r1">done</th> \n                <th class="svelte-1fv41r1">actions</th></tr>',o=f();for(let t=0;t<s.length;t+=1)s[t].c();m(e,"class","table svelte-1fv41r1")},m(t,c){u(t,e,c),a(e,n),a(e,o);for(let t=0;t<s.length;t+=1)s[t].m(e,null)},p(t,n){const o=t[2];s=function(t,e,n,o,s,c,r,a,u,i,l,d){let f=t.length,p=c.length,m=f;const h={};for(;m--;)h[t[m].key]=m;const $=[],g=new Map,v=new Map;for(m=p;m--;){const t=d(s,c,m),a=n(t);let u=r.get(a);u?o&&u.p(t,e):(u=i(a,t)).c(),g.set(a,$[m]=u),a in h&&v.set(a,Math.abs(m-h[a]))}const b=new Set,y=new Set;function x(t){P(t,1),t.m(a,l),r.set(t.key,t),l=t.first,p--}for(;f&&p;){const e=$[p-1],n=t[f-1],o=e.key,s=n.key;e===n?(l=e.first,f--,p--):g.has(s)?!r.has(o)||b.has(o)?x(e):y.has(s)?f--:v.get(o)>v.get(s)?(y.add(o),x(e)):(b.add(s),f--):(u(n,r),f--)}for(;f--;){const e=t[f];g.has(e.key)||u(e,r)}for(;p;)x($[p-1]);return $}(s,n,d,1,t,o,c,e,M,pt,null,dt)},d(t){t&&i(e);for(let t=0;t<s.length;t+=1)s[t].d()}}}function pt(t,e){let n,s,c,r,$,g,v,b,y,x,w,E,k,C,S,_,T,j,N,L=e[9].data.date+"",O=e[9].data.description+"",P=e[9].data.amount+"",D=e[9].data.done?"✅":"❌";function M(...t){return e[7](e[9],...t)}function J(...t){return e[8](e[9],...t)}return{key:t,first:null,c(){n=l("tr"),s=l("td"),c=d(L),r=f(),$=l("td"),g=d(O),v=f(),b=l("td"),y=d(P),x=f(),w=l("td"),E=d(D),k=f(),C=l("td"),(S=l("button")).textContent="Edit",_=f(),(T=l("button")).textContent="Delete",j=f(),m(s,"class","svelte-1fv41r1"),m($,"class","svelte-1fv41r1"),m(b,"class","svelte-1fv41r1"),m(w,"class","svelte-1fv41r1"),m(S,"class","svelte-1fv41r1"),m(T,"class","svelte-1fv41r1"),m(C,"class","svelte-1fv41r1"),N=[p(S,"click",M),p(T,"click",J)],this.first=n},m(t,e){u(t,n,e),a(n,s),a(s,c),a(n,r),a(n,$),a($,g),a(n,v),a(n,b),a(b,y),a(n,x),a(n,w),a(w,E),a(n,k),a(n,C),a(C,S),a(C,_),a(C,T),a(n,j)},p(t,n){e=t,4&n&&L!==(L=e[9].data.date+"")&&h(c,L),4&n&&O!==(O=e[9].data.description+"")&&h(g,O),4&n&&P!==(P=e[9].data.amount+"")&&h(y,P),4&n&&D!==(D=e[9].data.done?"✅":"❌")&&h(E,D)},d(t){t&&i(n),o(N)}}}function mt(e){let n,o;return{c(){(n=l("button")).textContent="Create new document",o=p(n,"click",e[3])},m(t,e){u(t,n,e)},p:t,i:t,o:t,d(t){t&&i(n),o()}}}function ht(t){let e;const n=new lt({props:{document:t[1]}});return n.$on("done",t[5]),{c(){J(n.$$.fragment)},m(t,o){A(n,t,o),e=!0},p(t,e){const o={};2&e&&(o.document=t[1]),n.$set(o)},i(t){e||(P(n.$$.fragment,t),e=!0)},o(t){D(n.$$.fragment,t),e=!1},d(t){H(n,t)}}}function $t(t){let e,n,o,s,c,r,a,p=t[2].length&&ft(t);const m=[ht,mt],h=[];function $(t,e){return t[0]?0:1}return s=$(t),c=h[s]=m[s](t),{c(){(e=l("h1")).textContent="Documents",n=f(),p&&p.c(),o=f(),c.c(),r=d("")},m(t,c){u(t,e,c),u(t,n,c),p&&p.m(t,c),u(t,o,c),h[s].m(t,c),u(t,r,c),a=!0},p(t,[e]){t[2].length?p?p.p(t,e):((p=ft(t)).c(),p.m(o.parentNode,o)):p&&(p.d(1),p=null);let n=s;(s=$(t))===n?h[s].p(t,e):(L(),D(h[n],1,1,()=>{h[n]=null}),O(),(c=h[s])||(c=h[s]=m[s](t)).c(),P(c,1),c.m(r.parentNode,r))},i(t){a||(P(c),a=!0)},o(t){D(c),a=!1},d(t){t&&i(e),t&&i(n),p&&p.d(t),t&&i(o),h[s].d(t),t&&i(r)}}}function gt(t,e,n){let o;r(t,at,t=>n(2,o=t));let s=!1,c={};function a(t){n(1,c=t),n(0,s=!0)}function u(t){c.id===t&&(n(0,s=!1),n(1,c={})),at.delete_(t)}return[s,c,o,function(){n(1,c={id:null,data:{date:"",description:"",amount:0,done:!1}}),n(0,s=!0)},a,function(){n(0,s=!1),n(1,c={})},u,t=>a(t),t=>u(t.id)]}class vt extends V{constructor(t){super(),U(this,t,gt,$t,c,{})}}function bt(e){let n,o;return{c(){(n=l("button")).textContent="Register",m(n,"class","svelte-b1nvja"),o=p(n,"click",e[5])},m(t,e){u(t,n,e)},p:t,d(t){t&&i(n),o()}}}function yt(e){let n,o;return{c(){(n=l("button")).textContent="Log in",m(n,"class","svelte-b1nvja"),o=p(n,"click",e[4])},m(t,e){u(t,n,e)},p:t,d(t){t&&i(n),o()}}}function xt(t){let e,n,o,s;return{c(){e=l("a"),n=d("Logout ("),o=d(t[3]),s=d(")"),m(e,"class","button svelte-b1nvja"),m(e,"href","/user/logout")},m(t,c){u(t,e,c),a(e,n),a(e,o),a(e,s)},p(t,e){8&e&&h(o,t[3])},d(t){t&&i(e)}}}function wt(t){let e;const n=new B({props:{type:"register"}});return{c(){J(n.$$.fragment)},m(t,o){A(n,t,o),e=!0},i(t){e||(P(n.$$.fragment,t),e=!0)},o(t){D(n.$$.fragment,t),e=!1},d(t){H(n,t)}}}function Et(t){let e;const n=new B({});return{c(){J(n.$$.fragment)},m(t,o){A(n,t,o),e=!0},i(t){e||(P(n.$$.fragment,t),e=!0)},o(t){D(n.$$.fragment,t),e=!1},d(t){H(n,t)}}}function kt(t){let e;const n=new vt({});return{c(){J(n.$$.fragment)},m(t,o){A(n,t,o),e=!0},i(t){e||(P(n.$$.fragment,t),e=!0)},o(t){D(n.$$.fragment,t),e=!1},d(t){H(n,t)}}}function Ct(t){let e,n,o,s,c,r,d,p,h,$,g;function v(t,e){return t[2]?xt:t[1]?yt:t[0]?bt:void 0}let b=v(t),y=b&&b(t);const x=[kt,Et,wt],w=[];function E(t,e){return t[2]?0:t[0]?1:t[1]?2:-1}return~(h=E(t))&&($=w[h]=x[h](t)),{c(){e=l("header"),(n=l("div")).innerHTML='<a href="/">actix crud</a>',o=f(),s=l("div"),c=f(),r=l("div"),y&&y.c(),d=f(),p=l("main"),$&&$.c(),m(n,"class","brand svelte-b1nvja"),m(s,"class","menu"),m(r,"class","login svelte-b1nvja"),m(e,"class","svelte-b1nvja"),m(p,"class","svelte-b1nvja")},m(t,i){u(t,e,i),a(e,n),a(e,o),a(e,s),a(e,c),a(e,r),y&&y.m(r,null),u(t,d,i),u(t,p,i),~h&&w[h].m(p,null),g=!0},p(t,[e]){b===(b=v(t))&&y?y.p(t,e):(y&&y.d(1),(y=b&&b(t))&&(y.c(),y.m(r,null)));let n=h;(h=E(t))!==n&&($&&(L(),D(w[n],1,1,()=>{w[n]=null}),O()),~h?(($=w[h])||($=w[h]=x[h](t)).c(),P($,1),$.m(p,null)):$=null)},i(t){g||(P($),g=!0)},o(t){D($),g=!1},d(t){t&&i(e),y&&y.d(),t&&i(d),t&&i(p),~h&&w[h].d()}}}function St(t,e,n){let o,s;r(t,W,t=>n(2,o=t)),r(t,Q,t=>n(3,s=t));let c=!o,a=!1;return[c,a,o,s,function(){n(1,a=!1),n(0,c=!0)},function(){n(0,c=!1),n(1,a=!0)}]}return new class extends V{constructor(t){super(),U(this,t,St,Ct,c,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
